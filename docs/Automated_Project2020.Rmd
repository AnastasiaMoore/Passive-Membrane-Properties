---
title: "Passive Membrane Properties of Dorsal Horn Neurons"
author: "Anastasia Lysenko"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
    toc: true
    toc_float: true
---

<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
 
 function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
 }
</script>

```{r, include=FALSE}
library(mosaic)
library(car)
library(pander)
library(DT) 
library(tidyverse)
library(dplyr)
library(plotly)


results <-read_csv("2020_03_20_and_2020_02_13.csv")
```



## Introduction  {.tabset .tabset-fade}


### Hide Data

There are many diseases or injuries affecting the central nervous system (e.g. Alzheimer's disease, Parkinson's disease, traumatic injury) that afflict millions of people throughout the globe. There has been a lot of progress done in the past to better combat these afflictions. Yet, a lot is still unclear. One step forward is classifying and characterizing different neurons in the brain and the spinal cord. A cell’s electrical properties are directly derived from the electrical properties of its membrane. Thus, this project will involve analysis of passive membrane properties (resistance and capacitance) as well as resting potential which will help in the classification of different neuron cells into groups with similar properties. 

These parameters will be determined from whole-cell patch-clamp recordings in current-clamp mode with zero input current and in voltage-clamp mode. The analysis could be done on currents induced by a brief voltage step.

All in all, the aim of this project is to test this approach for calculating passive membrane parameters from electrophysiological recordings and use them to characterize dorsal horn neurons from laminae I and II of the spinal cord.

The following document seeks to answer a question if light stimulation of RVM descendaing fibers changes passive membrane properties: membrane resistance($R_m$) and membrane capacitance($C_m$).


### Show Data

These results come from 2 adult mice which had 50 nl of ChR2 and YFP-producing viruses injected for 8 weeks. Axon Instruments electrophysiological equipment was used to record lamina I neuron cells' responses from the Lumbar (L1–6) area of the spinal cord in the whole-cell patch-clamp mode. Optogenetic techniques (with monochromator) were applied for the activation of RVM descending axons. Total of 8 cells were successfully patched and had the data recorded on them. 

* 'file': the name of the file where the data was calculated from.

* 'peak': the amplitude of the peak of the cell's current recording when the voltage applied is changed by 10 mV and is measured in $pA$.

* 'plato': mean value of a stabilized current recording after the capacitor is completely recharged and is measured in $pA$.


* 'Ra': Access Resistance and is measured in $M\Omega$ - resistance between electrodes and the inside environment of the cell, or, in other words, the sum of the pipette resistance and the residual resistance of the ruptured patch.

* 'Rm+Ra': the sum of membrane and access resistances and is measured in $M\Omega$.

* 'Rm': membrane resistance and is measured in $M\Omega$.

* 'tau': time constant for the capacitive current to fall to within 1/e of zero and is measured  in $ms$.

* 'Cm': membrane capacitance and is measured in $pF$.

* 'Ih': holding current while voltage clamping a cell (the current that is passed into the cell in order to hold it at the command potential) measured in $pA$.

* 'Cell': a cell number from which the measurements were recorded.


* 'Stimulation_Type': denotes what type of stimulation was performed for a particular data piece. There were three different types:

  1. "control" - when only the electrical stimulation of the dorsal root was performed.

  2. "monochromator" - when both electrical stimulations of the dorsal root and optogenetic stimulation of RVM    descending fibers using 480nm 5Hz 5ms monochromator were performed.

* 'VC': current recording when voltage was applied (in a voltage-clamp mode) and is measured in $mV$.



```{r}
datatable(results)
```






## Initial Analysis {.tabset .tabset-fade}

### $R_m$ {.tabset .tabset-fade}

Since we are interested in knowing if there is a difference in the 'Rm' values of the spinal cord cells after electrical stimulation of dorsal root with and without simultaneous RVM axons stimulation by light our null and alternative hypotheses for all 3 cells are as follows: 


$$
  H_0: \mu_{control} = \mu_{monochromator}
$$

$$
  H_a: \mu_{control} \neq \mu_{monochromator}
$$

where,

$\mu_{control}$ is the mean membrane resistance value $R_m$ of the patched cell's response after the axons of RVM were electrically stimulated (in $MΩ$); 

$\mu_{monochromator}$ is the mean membrane resistance value $R_m$ of the patched cell's response after the axons of RVM were simultaneously stimulated electrically and with a monochromator (in $MΩ$).

The level of significance is set at $\alpha$ = 0.05 for this study.

<!-- #### Summary of all Cells together  {.tabset .tabset-fade} -->

#### Summary of all Cells together
<!-- ##### C + M -->

<!-- **Control and Monochromator Combined** -->


<!-- ```{r message=FALSE, warning=FALSE} -->

<!-- library(gdata) -->
<!-- library(reshape2) -->
<!-- library(ggplot2) -->

<!-- ylim1 = c(0, 1200) -->

<!-- ggplot(results, aes(x = Cell, y = Rm, group = Cell, fill = Stimulation_Type)) + -->
<!--   geom_boxplot()+ -->
<!--   coord_cartesian(ylim = ylim1)+  -->
<!--   theme_light()+  -->
<!--   scale_x_discrete(limits=c("1","2","3","4","5","6","7","8"))+ -->
<!--   ggtitle(c(expression(R[m]~"comparison of All Cells"))) + -->
<!--   ylab(expression(R[m]~" (MOhm)"))  + -->
<!--   theme(legend.title=element_text(size=16), plot.title = element_text(size = 20), axis.title=element_text(size=16)) -->


<!-- ``` -->


<!-- ```{r message=FALSE, warning=FALSE} -->
<!-- results %>% -->
<!-- group_by(Cell) %>% -->
<!--   summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm of All Cells", split.table=Inf) -->
<!-- ``` -->



<!-- ##### C & M -->

<!-- **Control and Monochromator Separately** -->


```{r fig.height=8, fig.width=14, message=FALSE, warning=FALSE}
# library
library(ggplot2)
ylim1 = c(0, 1200)

results$Cell <- as.factor(results$Cell)
results_color <- results %>% 
  mutate(
    Rmpvalue = case_when(
           Cell == 1 ~ "high",
           Cell == 2 ~ "high",
           Cell == 3 ~ "low",
           Cell == 4 ~ "high",
           Cell == 5 ~ "high",
           Cell == 6 ~ "low",
           Cell == 7 ~ "high",
           Cell == 8 ~ "low")
  )


results_color <- results_color %>% 
     mutate(
         colorgroup = case_when(
           Stimulation_Type == "control" & Rmpvalue == "high" ~ "gray58",
           Stimulation_Type == "monochromator" & Rmpvalue == "high" ~ "gray82",
           Stimulation_Type == "control" & Rmpvalue == "low" ~ "skyblue",
           Stimulation_Type == "monochromator" & Rmpvalue == "low" ~ "orange"
          )
        )    

legend_title <- "Stimulation Type"


ggplot(results_color, aes(x=Cell, y=Rm, fill=colorgroup)) +
  geom_boxplot()+ 
  theme_light()+
  coord_cartesian(ylim = ylim1)+
  scale_fill_manual(legend_title,values = c("gray58", "gray82","skyblue","orange"), labels = c("non-signifcant control", "non-significant monochromator", "significant control", "significant monochromator"))+
  ggtitle("Optogenetically Stimulated vs Control\nAdult Mice Dorsal Horn Cells") +
  ylab(expression(R[m]~" (MOhm)")) +
  theme(legend.title=element_text(size=20), plot.title = element_text(size = 30, hjust = 0.5), axis.title=element_text(size=20), legend.text=element_text(size=14), axis.text.x = element_text(size = 14),  axis.text.y = element_text(size = 14))


```    

```{r, message=FALSE, warning=FALSE}
results %>%
group_by(Cell, Stimulation_Type)%>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm of All Cells control vs Monochromator", split.table=Inf)
```


#### Summary of each Cell individually {.tabset .tabset-fade}

##### Cell 1 


Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell1results <- filter(results, Cell == 1)

test <- t.test(Rm~Stimulation_Type, data = cell1results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Rm~Stimulation_Type, data = cell1results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell1results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem2')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell1results$Rm[cell1results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell1results$Rm[cell1results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Rm~Stimulation_Type, data = cell1results), split.table=Inf)
```

Since, our P-value is `r pvalueis` ( `r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.



##### Cell 2 

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell2results <- filter(results, Cell == 2)

test <- t.test(Rm~Stimulation_Type, data = cell2results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell2results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell2results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell2results$Rm[cell2results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell2results$Rm[cell2results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```





</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell2results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.



##### Cell 3 

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell3results <- filter(results, Cell == 3)

test <- t.test(Rm~Stimulation_Type, data = cell3results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell3results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell3")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell3results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell3results$Rm[cell3results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell3results$Rm[cell3results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```






</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell3results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.

##### Cell 4

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell4results <- filter(results, Cell == 4)

test <- t.test(Rm~Stimulation_Type, data = cell4results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell4results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell4")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell4results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell4results$Rm[cell4results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell4results$Rm[cell4results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell4results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.

##### Cell 5

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell5results <- filter(results, Cell == 5)

test <- t.test(Rm~Stimulation_Type, data = cell5results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell5results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell5")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell5results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell5results$Rm[cell5results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell5results$Rm[cell5results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell5results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


##### Cell 6 {.tabset .tabset-fade}

###### VC = -10

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell6results_10 <- filter(results, Cell == 6 & VC == -10)

test <- t.test(Rm~Stimulation_Type, data = cell6results_10)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell6results_10,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell6")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell6results_10 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell6results_10$Rm[cell6results_10$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell6results_10$Rm[cell6results_10$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell6results_10), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


###### VC = -60

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell6results_60 <- filter(results, Cell == 6 & VC == -60)

test <- t.test(Rm~Stimulation_Type, data = cell6results_60)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell6results_60,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell6")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell6results_60 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell6results_60$Rm[cell6results_60$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell6results_60$Rm[cell6results_60$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell6results_60), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.



##### Cell 7

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell7results <- filter(results, Cell == 7)

test <- t.test(Rm~Stimulation_Type, data = cell7results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell7results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell7")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell7results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell7results$Rm[cell7results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell7results$Rm[cell7results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell7results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.

##### Cell 8 {.tabset .tabset-fade}

###### VC = -10

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell8results_10 <- filter(results, Cell == 8 & VC == -10)

test <- t.test(Rm~Stimulation_Type, data = cell8results_10)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell8results_10,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell8")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell8results_10 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell8results_10$Rm[cell8results_10$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell8results_10$Rm[cell8results_10$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell8results_10), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.

###### VC = -60

Below is the boxplot comparison of the $R_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}
cell8results_60 <- filter(results, Cell == 8 & VC == -60)

test <- t.test(Rm~Stimulation_Type, data = cell8results_60)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}

boxplot(Rm~Stimulation_Type, data = cell8results_60,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell8")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
cell8results_60 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm), Q1 = quantile(Rm, 0.25), med = median(Rm), Q3 = quantile(Rm, 0.75), max = max(Rm), mean=mean(Rm), sd =sd(Rm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm Cell2", split.table=Inf)
```

<a href="javascript:showhide('tablem222')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem222" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell8results_60$Rm[cell8results_60$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm", id=FALSE)
qqPlot(cell8results_60$Rm[cell8results_60$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm", id=FALSE)
```



</div>

Here are the results we get:

```{r }
pander(t.test(Rm~Stimulation_Type, data = cell8results_60), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.



### $C_m$ {.tabset .tabset-fade}


Since we are interested in knowing if there is a difference in the 'Cm' values of the spinal cord cells after electrical stimulation of dorsal root with and without simultaneous RVM axons stimulation by light our null and alternative hypotheses for all 3 cells are as follows: 


$$
  H_0: \mu_{control} = \mu_{monochromator}
$$

$$
  H_a: \mu_{control} \neq \mu_{monochromator}
$$

where,

$\mu_{control}$ is the mean membrane capacitance value $C_m$ of the patched cell's response after the axons of RVM were electrically stimulated (in $pF$); 

$\mu_{monochromator}$ is the mean membrane capacitance value $C_m$ of the patched cell's response after the axons of RVM were simultaneously stimulated electrically and with a monochromator (in $pF$).

The level of significance is set at $\alpha$ = 0.05 for this study.

<!-- #### Summary of all Cells together{.tabset .tabset-fade} -->

#### Summary of all Cells together
<!-- ##### C + M -->


<!-- **Control and Monochromator Combined** -->


<!-- ```{r message=FALSE, warning=FALSE} -->

<!-- ylim1 = c(0, 12) -->

<!-- ggplot(results, aes(x = Cell, y = Cm, group = Cell, fill = Stimulation_Type)) + -->
<!--   geom_boxplot()+ -->
<!--   coord_cartesian(ylim = ylim1)+  -->
<!--   theme_light()+  -->
<!--   scale_x_discrete(limits=c("1","2","3","4","5","6","7","8"))+ -->
<!--   ggtitle(c(expression(C[m]~"comparison of All Cells"))) + -->
<!--   ylab(expression(C[m]~" (pF)"))  + -->
<!--   theme(legend.title=element_text(size=16), plot.title = element_text(size = 20), axis.title=element_text(size=16)) -->


<!-- ``` -->


<!-- ```{r message=FALSE, warning=FALSE} -->
<!-- results %>% -->
<!-- group_by(Cell) %>% -->
<!--   summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm of All Cells", split.table=Inf) -->
<!-- ``` -->



<!-- ```{r} -->

<!-- boxplot(Cm~Cell, data = results,outline=FALSE, main = c(expression(C[m]~"comparison of Different Cells")), xlab ="Cell", ylab=c(expression(C[m]~" (pF)"))) -->
<!-- ``` -->

<!-- ##### C & M -->

<!-- **Control and Monochromator Separately** -->



```{r fig.height=8, fig.width=14, message=FALSE, warning=FALSE}
# library
library(ggplot2)
ylim2 = c(0, 12)

results$Cell <- as.factor(results$Cell)
results_color <- results %>% 
  mutate(
    Cmpvalue = case_when(
           Cell == 1 ~ "low",
           Cell == 2 ~ "low",
           Cell == 3 ~ "high",
           Cell == 4 ~ "high",
           Cell == 5 ~ "low",
           Cell == 6 ~ "low",
           Cell == 7 ~ "high",
           Cell == 8 ~ "low")
  )


results_color <- results_color %>% 
     mutate(
         colorgroup_Cm = case_when(
           Stimulation_Type == "control" & Cmpvalue == "high" ~ "gray58",
           Stimulation_Type == "monochromator" & Cmpvalue == "high" ~ "gray82",
           Stimulation_Type == "control" & Cmpvalue == "low" ~ "skyblue",
           Stimulation_Type == "monochromator" & Cmpvalue == "low" ~ "orange"
          )
        )    

legend_title <- "Stimulation Type"


ggplot(results_color, aes(x=Cell, y=Cm, fill=colorgroup_Cm)) +
  geom_boxplot()+ 
  theme_light()+
  coord_cartesian(ylim = ylim2)+
  scale_fill_manual(legend_title,values = c("gray58", "gray82","skyblue","orange"), labels = c("non-signifcant control", "non-significant monochromator", "significant control", "significant monochromator"))+
  ggtitle("Optogenetically Stimulated vs Control\nAdult Mice Dorsal Horn Cells") +
  ylab(expression(C[m]~" (pF)")) +
  theme(legend.title=element_text(size=20), plot.title = element_text(size = 30, hjust = 0.5), axis.title=element_text(size=20), legend.text=element_text(size=14), axis.text.x = element_text(size = 14),  axis.text.y = element_text(size = 14))



```    

```{r, message=FALSE, warning=FALSE}
results %>%
group_by(Cell, Stimulation_Type)%>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm of All Cells control vs Monochromator", split.table=Inf)
```



```{r fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
# library
library(ggplot2)

results$Cell <- as.factor(results$Cell)

legend_title <- "Stimulation Type"


ggplot(results, aes(x=Cell, y=Cm, fill=Stimulation_Type)) +
  geom_boxplot()+ 
  theme_light()+
  coord_cartesian(ylim = ylim1)+
  scale_fill_manual(legend_title,values = c("skyblue","orange"))+
  ggtitle(c(expression(C[m]~"comparison of Control & Monochromator"))) +
  ylab(expression(C[m]~" (MOhm)")) +
  theme(legend.title=element_text(size=20), plot.title = element_text(size = 30), axis.title=element_text(size=20), legend.text=element_text(size=14))



```    

```{r message=FALSE, warning=FALSE}
results %>%
group_by(Cell, Stimulation_Type)%>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm of All Cells control vs Monochromator", split.table=Inf)
```



#### Summary of each Cell individually {.tabset .tabset-fade}

##### Cell 1 

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell1results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell1results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell1results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell1results$Cm[cell1results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell1results$Cm[cell1results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell1results), split.table=Inf)
```


Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



##### Cell 2 

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell2results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell2results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell2results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell2results$Cm[cell2results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell2results$Cm[cell2results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell2results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


##### Cell 3 

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell3results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell3results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell3")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell3results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell3results$Cm[cell3results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell3results$Cm[cell3results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell3results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.

##### Cell 4

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell4results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell4results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell4")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell4results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell4results$Cm[cell4results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell4results$Cm[cell4results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell4results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


##### Cell 5

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell5results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell5results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell5")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell5results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell5results$Cm[cell5results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell5results$Cm[cell5results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell5results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


##### Cell 6 {.tabset .tabset-fade}

###### VC = -10

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell6results_10)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell6results_10,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell6")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell6results_10 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell6results_10$Cm[cell6results_10$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell6results_10$Cm[cell6results_10$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell6results_10), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


###### VC = -60

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell6results_60)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell6results_60,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell6")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell6results_60 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell6results_60$Cm[cell6results_60$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell6results_60$Cm[cell6results_60$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell6results_60), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


##### Cell 7

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell7results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell7results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell7")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell7results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell7results$Cm[cell7results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell7results$Cm[cell7results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell7results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



##### Cell 8{.tabset .tabset-fade}

###### VC = -10

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell8results_10)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell8results_10,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell8")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell8results_10 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell8results_10$Cm[cell8results_10$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell8results_10$Cm[cell8results_10$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell8results_10), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.


###### VC = -60

Below is the boxplot comparison of the $C_m$ values of the cell that was not stimulated by light (control) and the values when it was stimulated by light (monochromator):

```{r}

test <- t.test(Cm~Stimulation_Type, data = cell8results_60)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm~Stimulation_Type, data = cell8results_60,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell8")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
cell8results_60 %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm), Q1 = quantile(Cm, 0.25), med = median(Cm), Q3 = quantile(Cm, 0.75), max = max(Cm), mean=mean(Cm), sd =sd(Cm), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem24')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem24" style="display:none;">



```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(cell8results_60$Cm[cell8results_60$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Cm", id=FALSE)
qqPlot(cell8results_60$Cm[cell8results_60$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Cm", id=FALSE)
```




</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm~Stimulation_Type, data = cell8results_60), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.





## Normalized Data Analysis{.tabset .tabset-fade}


### Hide Data {.tabset .tabset-fade}

```{r message=FALSE, warning=FALSE}
norm_results <-read_csv("Normalization_result.csv")
norm_results$X1 <- NULL
```


#### $R_m$ 



```{r message=FALSE, warning=FALSE}
test <- t.test(Rm_scaled~Stimulation_Type, data = norm_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Rm_scaled~Stimulation_Type, data = norm_results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
norm_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm_scaled), Q1 = quantile(Rm_scaled, 0.25), med = median(Rm_scaled), Q3 = quantile(Rm_scaled, 0.75), max = max(Rm_scaled), mean=mean(Rm_scaled), sd =sd(Rm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm_scaled Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem2norm22')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2norm22" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(norm_results$Rm_scaled[norm_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(norm_results$Rm_scaled[norm_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:

```{r}
myTest<-t.test(Rm_scaled~Stimulation_Type, data = norm_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(norm_results$Stimulation_Type)
  permutedTest <- t.test(Rm_scaled ~ permutedData, data = norm_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```

</div>

Here are the results we get:

```{r }
pander(t.test(Rm_scaled~Stimulation_Type, data = norm_results), split.table=Inf)
```



Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


#### $C_m$ 


```{r message=FALSE, warning=FALSE}

test <- t.test(Cm_scaled~Stimulation_Type, data = norm_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm_scaled~Stimulation_Type, data = norm_results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
norm_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm_scaled), Q1 = quantile(Cm_scaled, 0.25), med = median(Cm_scaled), Q3 = quantile(Cm_scaled, 0.75), max = max(Cm_scaled), mean=mean(Cm_scaled), sd =sd(Cm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm_scaled Cell1", split.table=Inf)
```


<a href="javascript:showhide('tablem2nn4')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2nn4" style="display:none;">


```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(norm_results$Rm_scaled[norm_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(norm_results$Rm_scaled[norm_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:
```{r}
myTest<-t.test(Cm_scaled~Stimulation_Type, data = norm_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(norm_results$Stimulation_Type)
  permutedTest <- t.test(Cm_scaled ~ permutedData, data = norm_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```


</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm_scaled~Stimulation_Type, data = norm_results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



### Show Data

Here is the link to the google colab where the data was normalized using MinMaxScaler() from sklearn.preprocessing to obtain columns 'Rm_scaled' and 'Cm_scaled':

[https://colab.research.google.com/gist/stassy8/ecbdab4168879c5f1177e650481df3af/min_max_datanormalization.ipynb](https://colab.research.google.com/gist/stassy8/ecbdab4168879c5f1177e650481df3af/min_max_datanormalization.ipynb)


```{r}
datatable(norm_results)
```





## Standardized Data Analysis{.tabset .tabset-fade}


### Hide Data {.tabset .tabset-fade}

```{r message=FALSE, warning=FALSE}
standard_results <-read_csv("Standardization_result.csv")
standard_results$X1 <- NULL
```


#### $R_m$ 



```{r message=FALSE, warning=FALSE}
test <- t.test(Rm_scaled~Stimulation_Type, data = standard_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Rm_scaled~Stimulation_Type, data = standard_results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
standard_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm_scaled), Q1 = quantile(Rm_scaled, 0.25), med = median(Rm_scaled), Q3 = quantile(Rm_scaled, 0.75), max = max(Rm_scaled), mean=mean(Rm_scaled), sd =sd(Rm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm_scaled Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem2norm22pp')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2norm22pp" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(standard_results$Rm_scaled[standard_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(standard_results$Rm_scaled[standard_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:

```{r}
myTest<-t.test(Rm_scaled~Stimulation_Type, data = standard_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(standard_results$Stimulation_Type)
  permutedTest <- t.test(Rm_scaled ~ permutedData, data = standard_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```

</div>

Here are the results we get:

```{r }
pander(t.test(Rm_scaled~Stimulation_Type, data = standard_results), split.table=Inf)
```



Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


#### $C_m$ 


```{r message=FALSE, warning=FALSE}

test <- t.test(Cm_scaled~Stimulation_Type, data = standard_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm_scaled~Stimulation_Type, data = standard_results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
standard_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm_scaled), Q1 = quantile(Cm_scaled, 0.25), med = median(Cm_scaled), Q3 = quantile(Cm_scaled, 0.75), max = max(Cm_scaled), mean=mean(Cm_scaled), sd =sd(Cm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm_scaled Cell1", split.table=Inf)
```


<a href="javascript:showhide('tablem2nn477')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2nn477" style="display:none;">


```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(standard_results$Rm_scaled[standard_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(standard_results$Rm_scaled[standard_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:
```{r}
myTest<-t.test(Cm_scaled~Stimulation_Type, data = standard_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(standard_results$Stimulation_Type)
  permutedTest <- t.test(Cm_scaled ~ permutedData, data = standard_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```


</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm_scaled~Stimulation_Type, data = standard_results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



### Show Data

Here is the link to the google colab where the data was standardized using StandardScaler() from sklearn.preprocessing to obtain columns 'Rm_scaled' and 'Cm_scaled':

[https://colab.research.google.com/gist/stassy8/6059156381326be744cb015e467d4bae/standard_scalar_datastandardization.ipynb](https://colab.research.google.com/gist/stassy8/6059156381326be744cb015e467d4bae/standard_scalar_datastandardization.ipynb)


```{r}

datatable(standard_results)
```


## Normalized Data Light-Control and Control-Light Analysis{.tabset .tabset-fade}




### Light-Control{.tabset .tabset-fade}

#### Hide Data {.tabset .tabset-fade}

```{r message=FALSE, warning=FALSE}
LC_results <-read_csv("Normalization_result_LC.csv")
```


##### $R_m$ 



```{r message=FALSE, warning=FALSE}
test <- t.test(Rm_scaled~Stimulation_Type, data = LC_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Rm_scaled~Stimulation_Type, data = LC_results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
LC_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm_scaled), Q1 = quantile(Rm_scaled, 0.25), med = median(Rm_scaled), Q3 = quantile(Rm_scaled, 0.75), max = max(Rm_scaled), mean=mean(Rm_scaled), sd =sd(Rm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm_scaled Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem2norm22ppzz')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2norm22ppzz" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(LC_results$Rm_scaled[LC_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(LC_results$Rm_scaled[LC_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:

```{r}
myTest<-t.test(Rm_scaled~Stimulation_Type, data = LC_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(LC_results$Stimulation_Type)
  permutedTest <- t.test(Rm_scaled ~ permutedData, data = LC_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```

</div>

Here are the results we get:

```{r }
pander(t.test(Rm_scaled~Stimulation_Type, data = LC_results), split.table=Inf)
```



Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


##### $C_m$ 


```{r message=FALSE, warning=FALSE}

test <- t.test(Cm_scaled~Stimulation_Type, data = LC_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm_scaled~Stimulation_Type, data = LC_results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
LC_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm_scaled), Q1 = quantile(Cm_scaled, 0.25), med = median(Cm_scaled), Q3 = quantile(Cm_scaled, 0.75), max = max(Cm_scaled), mean=mean(Cm_scaled), sd =sd(Cm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm_scaled Cell1", split.table=Inf)
```


<a href="javascript:showhide('tablem2nn4aa77')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2nn4aa77" style="display:none;">


```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(LC_results$Rm_scaled[LC_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(LC_results$Rm_scaled[LC_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:
```{r}
myTest<-t.test(Cm_scaled~Stimulation_Type, data = LC_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(LC_results$Stimulation_Type)
  permutedTest <- t.test(Cm_scaled ~ permutedData, data = LC_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```


</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm_scaled~Stimulation_Type, data = LC_results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



#### Show Data

The data was filtered to only contain the sets that had first light recorded and then control.

```{r}

datatable(LC_results)
```



### Control-Light{.tabset .tabset-fade}

#### Hide Data {.tabset .tabset-fade}

```{r message=FALSE, warning=FALSE}
CL_results <-read_csv("Normalization_result_CL.csv")
```


##### $R_m$ 



```{r message=FALSE, warning=FALSE}
test <- t.test(Rm_scaled~Stimulation_Type, data = CL_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Rm_scaled~Stimulation_Type, data = CL_results,outline=FALSE, col=color, main = c(expression(R[m]~"comparison in Cell1")), xlab ="Stimulation Type", ylab=c(expression(R[m]~" (MOhm)")))
```


```{r message=FALSE, warning=FALSE}
CL_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Rm_scaled), Q1 = quantile(Rm_scaled, 0.25), med = median(Rm_scaled), Q3 = quantile(Rm_scaled, 0.75), max = max(Rm_scaled), mean=mean(Rm_scaled), sd =sd(Rm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Rm_scaled Cell1", split.table=Inf)
```

<a href="javascript:showhide('tablem2norm22ppzzqq')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tablem2norm22ppzzqq" style="display:none;">




```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(CL_results$Rm_scaled[CL_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(CL_results$Rm_scaled[CL_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:

```{r}
myTest<-t.test(Rm_scaled~Stimulation_Type, data = CL_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(CL_results$Stimulation_Type)
  permutedTest <- t.test(Rm_scaled ~ permutedData, data = CL_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```

</div>

Here are the results we get:

```{r }
pander(t.test(Rm_scaled~Stimulation_Type, data = CL_results), split.table=Inf)
```



Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane resistance of the cell changes significantly from that when there is no light stimulation.


##### $C_m$ 


```{r message=FALSE, warning=FALSE}

test <- t.test(Cm_scaled~Stimulation_Type, data = CL_results)
pvalue <- test[3]
if(pvalue < 0.05){
  pvalueis <- "significant"
  decision <- "we reject the null. This means that there is a significant"
  sign <- "<"
  color <-c("skyblue","orange")
} else {
  pvalueis <- "not significant"
  decision <- "we fail to reject the null. This means that there is no significant"
  sign <- ">"
  color <- c("gray58","gray82")
}


boxplot(Cm_scaled~Stimulation_Type, data = CL_results,outline=FALSE, col=color, main = c(expression(C[m]~"comparison in Cell2")), xlab ="Stimulation Type", ylab=c(expression(C[m]~" (pF)")))
```


```{r message=FALSE, warning=FALSE}
CL_results %>%
group_by(Stimulation_Type) %>%
  summarise(min = min(Cm_scaled), Q1 = quantile(Cm_scaled, 0.25), med = median(Cm_scaled), Q3 = quantile(Cm_scaled, 0.75), max = max(Cm_scaled), mean=mean(Cm_scaled), sd =sd(Cm_scaled), 'sample size'=n()) %>% pander(caption="Summary Statistics of Cm_scaled Cell1", split.table=Inf)
```


<a href="javascript:showhide('tabclem2nn4aa77')">Show the diagnostic plots<span style="font-size:8pt;">(click to view)</span></a>

<div id="tabclem2nn4aa77" style="display:none;">


```{r message=FALSE, warning=FALSE}
par(mfrow=c(1,2))
qqPlot(CL_results$Rm_scaled[CL_results$Stimulation_Type == "control"], main = "QQ-plot of control", ylab="Rm_scaled", id=FALSE)
qqPlot(CL_results$Rm_scaled[CL_results$Stimulation_Type == "monochromator"], main = "QQ-plot of monochromator", ylab="Rm_scaled", id=FALSE)
```

Because the data is not quiet normal, we will use Permutations Test that allows for non-parametric data and see what results we get:
```{r}
myTest<-t.test(Cm_scaled~Stimulation_Type, data = CL_results, mu = 0)
observedTestStat <- myTest$statistic

N <- 2000
permutedTestStats <- rep(NA, N)
for (i in 1:N){
  permutedData <- sample(CL_results$Stimulation_Type)
  permutedTest <- t.test(Cm_scaled ~ permutedData, data = CL_results, mu = 0)
  permutedTestStats[i] <- permutedTest$statistic
}

hist(permutedTestStats, col = "skyblue")
abline(v = observedTestStat, col = "red", lwd = 3)
```

This is the p-value we get:
```{r}
if (observedTestStat < 0){
 2*sum(permutedTestStats <= observedTestStat)/N 
} else{
  2*sum(permutedTestStats >= observedTestStat)/N
}

```


</div>

Here are the results of the Independent Samples t Test we get:

```{r}
pander(t.test(Cm_scaled~Stimulation_Type, data = CL_results), split.table=Inf)
```

Since, our P-value is `r pvalueis` (`r pvalue` `r sign` $\alpha$), `r decision` evidence to conclude that when the axons of RVM are stimulated with monochromator membrane capacitance of the cell changes significantly from that when there is no light stimulation.



#### Show Data

The data was filtered to only contain the sets that had first control recorded and then light.

```{r}

datatable(CL_results)
```


